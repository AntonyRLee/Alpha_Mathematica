(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16432,        477]
NotebookOptionsPosition[     15560,        456]
NotebookOutlinePosition[     15968,        472]
CellTagsIndexPosition[     15925,        469]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"M", "[", 
    RowBox[{"A_", ",", "F_"}], "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Boole", "[", 
      RowBox[{
       RowBox[{"Flatten", "[", 
        RowBox[{"StringCases", "[", 
         RowBox[{"F", ",", 
          RowBox[{"RegularExpression", "[", 
           RowBox[{
            RowBox[{"ToString", "[", "x", "]"}], "<>", "\"\<(?=(\>\"", " ", "<>", 
            RowBox[{"ToString", "[", "y", "]"}], " ", "<>", " ", 
            "\"\<))\>\""}], " ", "]"}]}], "]"}], "]"}], "!=", 
       RowBox[{"{", "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "A"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "A"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.886941084322921*^9, 3.8869410925133486`*^9}, {
   3.886943524727742*^9, 3.88694353567535*^9}, 3.886950612305131*^9},
 CellLabel->
  "In[498]:=",ExpressionUUID->"b755393e-a9f4-4ee0-8c17-5ff7ca474509"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"fd", "[", 
    RowBox[{"M_", ",", "A_", ",", "B_"}], "]"}], ":=", 
   RowBox[{"Product", "[", 
    RowBox[{"x", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"M", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "A"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "B"}], "}"}]}], "]"}], "]"}]}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f1", "[", "M_", "]"}], ":=", 
   RowBox[{"M", "-", 
    RowBox[{"M", "*", 
     RowBox[{"Transpose", "[", "M", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f2", "[", "M_", "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "M", "]"}], ",", 
          RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], "-", "M"}], 
     ")"}], "*", 
    RowBox[{"Transpose", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "M", "]"}], ",", 
           RowBox[{"Length", "[", "M", "]"}]}], "}"}]}], "]"}], "-", "M"}], 
      ")"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f4", "[", 
    RowBox[{"P_", ",", "M_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"fd", "[", 
       RowBox[{
        RowBox[{"f1", "[", "M", "]"}], ",", "A", ",", "B"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"B", ",", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], "*", 
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"fd", "[", 
         RowBox[{
          RowBox[{"f2", "[", "M", "]"}], ",", "A", ",", "A"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"fd", "[", 
         RowBox[{
          RowBox[{"f2", "[", "M", "]"}], ",", "A", ",", "A"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", 
          RowBox[{"P", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}], "}"}]}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"f3", "[", 
     RowBox[{"P_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"P", "[", 
     RowBox[{"[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"SparseArray", "[", 
             RowBox[{"f4", "[", 
              RowBox[{"P", ",", "M"}], "]"}], "]"}], "[", 
            "\"\<NonzeroPositions\>\"", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}], "+", "1"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"SparseArray", "[", 
             RowBox[{"f4", "[", 
              RowBox[{"P", ",", "M"}], "]"}], "]"}], "[", 
            "\"\<NonzeroPositions\>\"", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}], "+", "1"}]}], 
       "}"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g1", "[", 
    RowBox[{"p_", ",", "n_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{"p", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", 
       RowBox[{"n", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g2", "[", 
    RowBox[{"p_", ",", "n_"}], "]"}], "=", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Binomial", "[", 
      RowBox[{"p", ",", "j"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "n"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", "[", 
   RowBox[{"p_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Normal", "[", 
   RowBox[{"SparseArray", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "i", "}"}], "\[Rule]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"g1", "[", 
           RowBox[{"p", ",", "n"}], "]"}], ",", 
          RowBox[{"g2", "[", 
           RowBox[{"p", ",", "n"}], "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          SuperscriptBox["2", "p"], "-", "1"}], "}"}], "\[Rule]", "0"}], 
       "}"}]}], "]"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj2", "[", 
   RowBox[{"p_", ",", "r_", ",", "c_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"pos", "[", 
       RowBox[{"p", ",", "r"}], "]"}], ",", 
      RowBox[{"pos", "[", 
       RowBox[{"p", ",", "i"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"c", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"jj3", "[", 
   RowBox[{"p_", ",", "r_", ",", "c_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"pos", "[", 
       RowBox[{"p", ",", "i"}], "]"}], ",", 
      RowBox[{"pos", "[", 
       RowBox[{"p", ",", "r"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", 
      RowBox[{"c", "-", "1"}]}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"jj4", "[", 
    RowBox[{"p_", ",", "r_", ",", "c_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"jj2", "[", 
     RowBox[{"p", ",", "r", ",", "c"}], "]"}], "+", 
    RowBox[{"jj3", "[", 
     RowBox[{"p", ",", "c", ",", "r"}], "]"}], "+", 
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", 
      RowBox[{"pos", "[", 
       RowBox[{"p", ",", "r"}], "]"}], ",", 
      RowBox[{"pos", "[", 
       RowBox[{"p", ",", "c"}], "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"jj5", "[", 
     RowBox[{"A_", ",", "P_", ",", "M_"}], "]"}], ":=", 
    RowBox[{"jj4", "[", 
     RowBox[{
      RowBox[{"Length", "[", "A", "]"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"f3", "[", 
         RowBox[{"P", ",", "M"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
      RowBox[{"Length", "[", 
       RowBox[{
        RowBox[{"f3", "[", 
         RowBox[{"P", ",", "M"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "]"}]}], " ", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"f5", "[", 
    RowBox[{"A_", ",", "P_", ",", "M_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"f4", "[", 
     RowBox[{"P", ",", "M"}], "]"}], "*", 
    RowBox[{"jj5", "[", 
     RowBox[{"A", ",", "P", ",", "M"}], "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.885892073989146*^9, 3.885892156268942*^9}, {
   3.8858922464190936`*^9, 3.8858923136873326`*^9}, {3.8858923767979193`*^9, 
   3.885892447403963*^9}, {3.8859111575452247`*^9, 3.885911181183367*^9}, {
   3.885911233736098*^9, 3.8859112345150104`*^9}, {3.885911286224554*^9, 
   3.88591128667127*^9}, 3.8859120335455046`*^9, {3.8859120682701173`*^9, 
   3.885912069317661*^9}, 3.8859133856778398`*^9, {3.885966172513627*^9, 
   3.8859661829861584`*^9}, {3.8859662733903637`*^9, 3.885966275117285*^9}, {
   3.8859663129197025`*^9, 3.885966326163289*^9}, {3.8859909160804253`*^9, 
   3.885991065915481*^9}, {3.885991118594408*^9, 3.885991132316377*^9}, {
   3.88599183145459*^9, 3.8859918647048416`*^9}, {3.8859920174060836`*^9, 
   3.885992019968303*^9}, {3.8863954763417053`*^9, 3.886395488118422*^9}, {
   3.8863955591978483`*^9, 3.8863955791532326`*^9}, 3.886487163640934*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"c76559ae-e90e-4f8e-89f5-3246e0d96523"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Logs", " ", "from", " ", "Process", " ", "Mining", " ", 
   RowBox[{"(", 
    RowBox[{"van", " ", "der", " ", "Aalst"}], ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.886952323692128*^9, 
  3.886952347806016*^9}},ExpressionUUID->"a57fbb2d-7af3-4708-9486-\
2e7e75435007"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"L1", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<abcd\>\"", ",", " ", "\"\<acbd\>\"", ",", " ", "\"\<aed\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L2", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<abcd\>\"", ",", "\"\<acbd\>\"", ",", "\"\<abcefbce\>\"", ",", " ", 
     "\"\<abcefcbd\>\"", ",", " ", "\"\<acbefbcd\>\"", ",", 
     "\"\<acbefbcefcbd\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L3", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<abcdefbdceg\>\"", ",", " ", "\"\<abdceg\>\"", ",", " ", 
     "\"\<abcdefbcdefbdceg\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L4", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<acd\>\"", ",", " ", "\"\<bcd\>\"", ",", " ", "\"\<ace\>\"", ",", 
     " ", "\"\<bce\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L5", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<abef\>\"", ",", " ", "\"\<abecdbf\>\"", ",", " ", "\"\<abcedbf\>\"", 
     ",", " ", "\"\<abcdebf\>\"", ",", " ", "\"\<aebcdbf\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L6", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<aceg\>\"", ",", "\"\<aecg\>\"", ",", "\"\<bdfg\>\"", ",", 
     "\"\<bfdg\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L7", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<ac\>\"", ",", "\"\<abc\>\"", ",", "\"\<abbc\>\"", ",", 
     "\"\<abbbbc\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L8", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<abd\>\"", ",", "\"\<abcbd\>\"", ",", "\"\<abcbcbd\>\""}], 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L9", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<acd\>\"", ",", "\"\<bce\>\""}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.88695113624275*^9, 3.886951243259491*^9}, {
  3.886951275397684*^9, 3.886951294549704*^9}, {3.886951342341921*^9, 
  3.8869516054096456`*^9}, {3.8869519051341596`*^9, 3.8869519127388964`*^9}},
 CellLabel->
  "In[533]:=",ExpressionUUID->"40b537d0-5b93-4beb-9855-c923acd19a8d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"F", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{"L4", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<a\>\"", "\[Rule]", "\"\<1\>\""}], ",", 
       RowBox[{"\"\<b\>\"", "\[Rule]", "\"\<2\>\""}], ",", 
       RowBox[{"\"\<c\>\"", "\[Rule]", "\"\<3\>\""}], ",", " ", 
       RowBox[{"\"\<d\>\"", "\[Rule]", "\"\<4\>\""}], ",", " ", 
       RowBox[{"\"\<e\>\"", "\[Rule]", "\"\<5\>\""}], ",", " ", 
       RowBox[{"\"\<f\>\"", " ", "\[Rule]", " ", "\"\<6\>\""}], " ", ",", " ", 
       RowBox[{"\"\<g\>\"", "\[Rule]", "\"\<7\>\""}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A1", " ", "=", " ", 
   RowBox[{"Sort", "[", 
    RowBox[{"DeleteDuplicates", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Characters", "[", "F", "]"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"Subsets", "[", "A1", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"P1", "[", 
     RowBox[{"[", "x", "]"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{"f5", "[", 
          RowBox[{"A1", ",", "P1", ",", 
           RowBox[{"M", "[", 
            RowBox[{"A1", ",", "F"}], "]"}]}], "]"}], "]"}], "[", 
        "\"\<NonzeroPositions\>\"", "]"}], "+", "1"}]}], "}"}]}], "]"}], "//",
   "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.8869516957401333`*^9, 3.8869516969934244`*^9}, {
  3.886951884435861*^9, 3.886951884655843*^9}, {3.88695191654818*^9, 
  3.88695193591562*^9}, {3.886951995275593*^9, 3.886952014927474*^9}, {
  3.886952062227479*^9, 3.886952062899848*^9}, {3.8869521845080357`*^9, 
  3.8869522354270115`*^9}, {3.886952296414635*^9, 3.88695229707223*^9}},
 CellLabel->
  "In[574]:=",ExpressionUUID->"c7e4e253-6b57-4d89-be77-62347c3e1e5a"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", "3", "}"}], 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}]},
     {
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], 
      RowBox[{"{", "3", "}"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.88695170470583*^9, 3.8869518859247985`*^9, {3.8869519217679243`*^9, 
   3.88695193980704*^9}, {3.8869519970923653`*^9, 3.8869520163050346`*^9}, 
   3.8869520667851706`*^9, {3.8869521858382435`*^9, 3.886952205672344*^9}, 
   3.8869522468459263`*^9, 3.886952298261148*^9},
 CellLabel->
  "Out[577]//MatrixForm=",ExpressionUUID->"9afa35ab-873a-4408-bc3b-\
65545f411072"]
}, Open  ]]
},
WindowSize->{958., 1005.5},
WindowMargins->{{Automatic, -964.5}, {375.5, Automatic}},
FrontEndVersion->"12.1 for Microsoft Windows (64-bit) (June 9, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"360ad5cc-b10f-4dc6-98b9-460562658626"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 969, 25, 48, "Input",ExpressionUUID->"b755393e-a9f4-4ee0-8c17-5ff7ca474509"],
Cell[1530, 47, 8562, 253, 361, "Input",ExpressionUUID->"c76559ae-e90e-4f8e-89f5-3246e0d96523"],
Cell[10095, 302, 314, 7, 28, "Input",ExpressionUUID->"a57fbb2d-7af3-4708-9486-2e7e75435007"],
Cell[10412, 311, 2098, 58, 184, "Input",ExpressionUUID->"40b537d0-5b93-4beb-9855-c923acd19a8d"],
Cell[CellGroupData[{
Cell[12535, 373, 1968, 49, 87, "Input",ExpressionUUID->"c7e4e253-6b57-4d89-be77-62347c3e1e5a"],
Cell[14506, 424, 1038, 29, 60, "Output",ExpressionUUID->"9afa35ab-873a-4408-bc3b-65545f411072"]
}, Open  ]]
}
]
*)

